@use "sass:color";

/* ==== Theme (dark minimal) ==== */
$bg: #0c0c0f;
$bg-active: #0b0f18;
$panel: #121317;
$stroke: #24262c;
$fg: #f5f7fa;
$muted: #a6adb9;
$accent: #ffffff;
$danger: #ff4d4d;
$ink: #0b0b0b;

$font: "Inter", "SF Pro Text", "Segoe UI", Roboto, system-ui, -apple-system,
  Arial, sans-serif;

@function ring($c, $a: 0.22) {
  @return 0 0 0 3px color.change($c, $alpha: $a);
}
@function hover($base, $ratio: 10%) {
  @return color.mix(#ffffff, $base, $ratio);
}

/* ==== Reset & base ==== */
* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}
:root {
  color-scheme: dark;
}
body {
  min-height: 100vh;
  font-family: $font;
  color: $fg;
  display: grid;
  place-items: center;
  padding: 24px;
  background: radial-gradient(
    1000px 700px at 20% 0%,
    #0e1016 0%,
    $bg 55%,
    #08090d 100%
  );
  transition: background 0.4s ease;
}
body:has(#app.alarm-active) {
  background: radial-gradient(
    1100px 750px at 18% 0%,
    #0f1422 0%,
    $bg-active 60%,
    #090d14 100%
  );
}

/* ==== Layout ==== */
main#app {
  width: min(900px, 100%);
  display: grid;
  gap: 24px;
}

/* ==== Clock ==== */
#clock {
  background: $panel;
  border: 1px solid $stroke;
  border-radius: 16px;
  padding: 28px;
  text-align: center;

  .time {
    font-size: clamp(3rem, 8vw, 4.8rem);
    font-weight: 800;
    letter-spacing: 0.02em;
  }
  .date {
    margin-top: 8px;
    color: $muted;
    font-size: 1.05rem;
  }
}

/* ==== Alarm ==== */
#alarm {
  background: $panel;
  border: 1px solid $stroke;
  border-radius: 16px;
  padding: 20px;
  display: grid;
  gap: 14px;

  .section-head {
    display: flex;
    align-items: baseline;
    justify-content: space-between;
    gap: 8px;
    h2 {
      font-size: 1.2rem;
      font-weight: 700;
    }
    .state-text {
      color: $muted;
      font-size: 0.95rem;
    }
  }

  .status {
    color: $muted;
    font-size: 0.95rem;
  }

  .alarm-form {
    display: grid;
    gap: 12px;
    .row {
      display: grid;
      gap: 12px;
    }
    .row.two {
      grid-template-columns: 1fr;
    }
    @media (min-width: 640px) {
      .row.two {
        grid-template-columns: 1fr 1fr;
      }
    }

    .field {
      display: grid;
      gap: 6px;
      label {
        color: $muted;
        font-size: 0.92rem;
      }
      input {
        background: #0f1116;
        color: $fg;
        border: 1px solid $stroke;
        border-radius: 12px;
        padding: 12px 14px;
        font-size: 1rem;
        transition: border-color 0.18s, box-shadow 0.18s;
        &:focus {
          outline: none;
          border-color: hover($stroke, 22%);
          box-shadow: ring($accent, 0.16);
        }
      }
    }

    .actions {
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
      align-items: center;
    }
  }

  .alarm-active-panel {
    display: grid;
    gap: 12px;
    .summary p {
      display: flex;
      gap: 8px;
      flex-wrap: wrap;
      align-items: center;
    }
    .summary .muted,
    .summary .sep {
      color: $muted;
    }
  }
}

/* ==== Buttons ==== */
button {
  padding: 12px 16px;
  border-radius: 12px;
  border: 1px solid $stroke;
  background: transparent;
  color: $fg;
  font-weight: 700;
  font-size: 1rem;
  cursor: pointer;
  transition: transform 0.06s, background-color 0.18s, border-color 0.18s,
    box-shadow 0.18s;
  &:active {
    transform: translateY(1px);
  }
  &:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }
}
#setBtn {
  background-color: $accent;
  color: $ink;
  border-color: color.mix($accent, $stroke, 60%);
  &:hover {
    background-color: hover($accent, 0%);
    border-color: color.mix($accent, $stroke, 48%);
  }
  &:focus {
    outline: none;
    box-shadow: ring($accent, 0.22);
  }
}
#cancelBtn {
  background-color: $danger;
  color: #fff;
  border-color: color.mix($danger, $stroke, 48%);
  &:hover {
    background-color: hover($danger, 6%);
    border-color: color.mix($danger, $stroke, 40%);
  }
  &:focus {
    outline: none;
    box-shadow: ring($danger, 0.22);
  }
}

/* ==== Sounds (1 slide visible) ==== */
#sounds {
  background: $panel;
  border: 1px solid $stroke;
  border-radius: 16px;
  padding: 20px;
  display: grid;
  gap: 12px;

  .section-head {
    display: flex;
    align-items: baseline;
    justify-content: space-between;
    gap: 8px;
    h2 {
      font-size: 1.1rem;
      font-weight: 700;
    }
    .muted {
      color: $muted;
      font-size: 0.95rem;
    }
  }

  .current-note {
    color: $muted;
    font-size: 0.95rem;
  }

  .sound-viewer {
    position: relative;
    display: grid;
    grid-template-columns: auto 1fr auto;
    align-items: center;
    gap: 8px;

    .nav {
      height: 40px;
      width: 40px;
      border-radius: 50%;
      border: 1px solid $stroke;
      background: color.change(#ffffff, $alpha: 0.06);
      color: $fg;
      display: grid;
      place-items: center;
      transition: background-color 0.18s, border-color 0.18s, transform 0.06s;
      &:hover {
        background: color.change(#ffffff, $alpha: 0.12);
      }
      &:active {
        transform: scale(0.98);
      }
      &:focus {
        outline: none;
        box-shadow: ring($accent, 0.18);
      }
    }

    .slide-window {
      position: relative;
      overflow: hidden;
      min-height: 150px;
    }

    .sound-card {
      position: absolute;
      inset: 0;
      display: grid;
      gap: 10px;
      align-content: center;
      justify-items: center;
      background: #0f1116;
      border: 1px solid $stroke;
      border-radius: 14px;
      padding: 16px;
      transform: translateX(100%);
      opacity: 0;
      transition: transform 0.25s ease, opacity 0.25s ease;

      .icon {
        font-size: 1.6rem;
      }
      .title {
        font-size: 1rem;
        font-weight: 700;
      }
      .btn-preview {
        padding: 10px 12px;
        border-radius: 10px;
        border: 1px solid $stroke;
        background: transparent;
        color: $fg;
        font-weight: 600;
        font-size: 0.95rem;
        transition: background-color 0.18s, border-color 0.18s, box-shadow 0.18s;
        &:hover {
          background: color.change(#ffffff, $alpha: 0.06);
        }
        &:focus {
          outline: none;
          box-shadow: ring($accent, 0.18);
        }
        &.is-playing {
          background: color.change(#ffffff, $alpha: 0.12);
          border-color: color.mix(#ffffff, $stroke, 28%);
        }
      }
      &[aria-hidden="true"] {
        pointer-events: none;
      }
      &.is-active {
        transform: translateX(0);
        opacity: 1;
      }
      &.from-left {
        transform: translateX(-100%);
      }
      &.from-right {
        transform: translateX(100%);
      }
    }
  }
  .volume {
    display: grid;
    gap: 8px;
    margin-top: 4px;
    label {
      color: $muted;
      font-size: 0.95rem;
    }
    input[type="range"] {
      width: 100%;
      appearance: none;
      height: 6px;
      border-radius: 999px;
      background: #1a1c22;
      border: 1px solid $stroke;
      &::-webkit-slider-thumb {
        appearance: none;
        width: 16px;
        height: 16px;
        border-radius: 50%;
        background: $accent;
        border: 1px solid color.mix($accent, $stroke, 55%);
      }
      &::-moz-range-thumb {
        width: 16px;
        height: 16px;
        border-radius: 50%;
        background: $accent;
        border: 1px solid color.mix($accent, $stroke, 55%);
      }
    }
  }
}

/* ==== Global states ==== */
#app.alarm-active #alarm {
  outline: 2px solid color.change(#6aa2ff, $alpha: 0.16);
}
#app.alarm-active #clock .time {
  text-shadow: 0 0 24px color.change(#6aa2ff, $alpha: 0.24);
}

/* ==== Helpers ==== */
.muted {
  color: $muted;
}
.hidden {
  display: none !important;
}

[hidden] {
  display: none !important;
}

/* Par sécurité UX : en état inactif, cacher le panneau actif et le statut */
#app.alarm-inactive #alarm .alarm-active-panel {
  display: none !important;
}
#app.alarm-inactive #alarm .status {
  display: none !important;
}
